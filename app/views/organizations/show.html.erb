<div class="container-md">
  <h2><%= @organization.name %></h2>
  <p><%= @organization.description %></p>

  <h5>Employees:</h5>
  <ul>
    <% @organization.employees.each do |employee| %>
      <li>
        <strong><%= employee.title %></strong>: 
        <%= link_to "#{employee.first_name} #{employee.last_name}", employee_path(employee), class: "text-primary" %>

        <% if policy(employee).destroy? %>
          <%= button_to "Delete", organization_employee_path(@organization, employee), 
                          method: :delete, 
                          data: { confirm: "Are you sure you want to delete this employee?" },
                          class: "btn btn-danger btn-sm" %>
        <% end %>
      </li>
    <% end %>
  </ul>

  <h5>Sub-organizations:</h5>
  <% @organization.sub_organizations.each do |sub_organization| %>
    <div class="sub-organization">
      <h6><%= sub_organization.name %></h6>
      <p><%= sub_organization.description %></p>

      <h6>Employees:</h6>
      <ul>
        <% sub_organization.employees.each do |employee| %>
          <li>
            <strong><%= employee.title %></strong>: 
            <%= link_to "#{employee.first_name} #{employee.last_name}", employee_path(employee) %>
          </li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <% if policy(Employee).create? %>
    <%= link_to "Add Employee", new_employee_path(organization_id: @organization.id), class: "btn btn-primary mt-3" %>
  <% end %>

  <%= link_to 'Back to Organizations', organizations_path, class: 'btn btn-secondary mt-3' %>

  <% if policy(@organization).edit? %>
    <%= link_to 'Edit Organization', edit_organization_path(@organization), class: 'btn btn-sm btn-secondary mt-3' %>
  <% end %>

  <% if policy(@organization).destroy? %>
    <%= button_to "Delete Organization", organization_path(@organization), 
        method: :delete, 
        data: { confirm: "Are you sure?" }, 
        class: "btn btn-danger mt-3" %>
  <% end %>
</div>
